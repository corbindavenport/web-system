// Web System 7 System.js

function Browser(){var a,b,c;this.isIE=false;this.isNS=false;this.version=null;a=navigator.userAgent;b="MSIE";if((c=a.indexOf(b))>=0){this.isIE=true;this.version=parseFloat(a.substr(c+b.length));return}b="Netscape6/";if((c=a.indexOf(b))>=0){this.isNS=true;this.version=parseFloat(a.substr(c+b.length));return}b="Gecko";if((c=a.indexOf(b))>=0){this.isNS=true;this.version=6.1;return}}function dragStart(a,b){var c;var d,e;if(b)dragObj.elNode=document.getElementById(b);else{if(browser.isIE)dragObj.elNode=window.event.srcElement;if(browser.isNS)dragObj.elNode=a.target;if(dragObj.elNode.nodeType==3)dragObj.elNode=dragObj.elNode.parentNode}if(browser.isIE){d=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;e=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}if(browser.isNS){d=a.clientX+window.scrollX;e=a.clientY+window.scrollY}dragObj.cursorStartX=d;dragObj.cursorStartY=e;dragObj.elStartLeft=parseInt(dragObj.elNode.style.left,10);dragObj.elStartTop=parseInt(dragObj.elNode.style.top,10);if(isNaN(dragObj.elStartLeft))dragObj.elStartLeft=0;if(isNaN(dragObj.elStartTop))dragObj.elStartTop=0;dragObj.elNode.style.zIndex=++dragObj.zIndex;if(browser.isIE){document.attachEvent("onmousemove",dragGo);document.attachEvent("onmouseup",dragStop);window.event.cancelBubble=true;window.event.returnValue=false}if(browser.isNS){document.addEventListener("mousemove",dragGo,true);document.addEventListener("mouseup",dragStop,true);a.preventDefault()}}function dragGo(a){var b,c;if(browser.isIE){b=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;c=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}if(browser.isNS){b=a.clientX+window.scrollX;c=a.clientY+window.scrollY}dragObj.elNode.style.left=dragObj.elStartLeft+b-dragObj.cursorStartX+"px";dragObj.elNode.style.top=dragObj.elStartTop+c-dragObj.cursorStartY+"px";if(browser.isIE){window.event.cancelBubble=true;window.event.returnValue=false}if(browser.isNS)a.preventDefault()}function dragStop(a){if(browser.isIE){document.detachEvent("onmousemove",dragGo);document.detachEvent("onmouseup",dragStop)}if(browser.isNS){document.removeEventListener("mousemove",dragGo,true);document.removeEventListener("mouseup",dragStop,true)}}function mopen(a){mcancelclosetime();if(ddmenuitem)ddmenuitem.style.visibility="hidden";ddmenuitem=document.getElementById(a);ddmenuitem.style.visibility="visible"}function mclose(){if(ddmenuitem)ddmenuitem.style.visibility="hidden"}function mclosetime(){closetimer=window.setTimeout(mclose,timeout)}function mcancelclosetime(){if(closetimer){window.clearTimeout(closetimer);closetimer=null}}var browser=new Browser;var dragObj=new Object;dragObj.zIndex=0;var timeout=500;var closetimer=0;var ddmenuitem=0;document.onclick=mclose